<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestalt: O Jogo dos Princípios</title>
    <!-- Carrega Tailwind CSS para estilização e responsividade -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Carrega as fontes do Google Fonts: Inter e Zilla Slab -->
    <style>
        /* MUDANÇA: Substituição de Roboto Slab por Zilla Slab na importação */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;700;900&family=Zilla+Slab:wght@400;700&display=swap');
        
        /* Cores Base */
        :root {
            --color-dark: #27272a; /* Cor de contraste escura (Dark Gray) */
            --color-light: #fafafa; /* Fundo principal claro e texto em blocos escuros */
            --color-medium-gray: #d0d0d0;
            --color-very-low-contrast: #e9e9e9;
        }

        /* Estilos de Tipografia */
        .font-sans-gestalt { font-family: 'Inter', sans-serif; }
        
        /* MUDANÇA: CORREÇÃO DE ESPECIFICIDADE para Zilla Slab */
        p.font-slab-gestalt { 
            font-family: 'Zilla Slab', serif !important; /* FORÇA a fonte Zilla Slab */
            font-weight: 400 !important; 
            line-height: 1.8 !important; 
        }
        
        /* Estilos globais conforme requisitos */
        body {
            background-color: var(--color-light); /* Fundo principal */
        }
        
        /* O SVG usa cores que invertem conforme a seção */
        .svg-shape-dark { fill: var(--color-dark); stroke: var(--color-dark); }
        .svg-shape-light { fill: var(--color-light); stroke: var(--color-light); }

        /* Cor do texto para as seções de jogo */
        .game-section-text { color: var(--color-dark); }
        
        /* Garante que o container principal esteja centralizado e com largura máxima */
        .main-container {
            max-width: 1440px;
            margin-left: auto;
            margin-right: auto;
        }

        /* ---------------------------------------------------- */
        /* Classe para alinhar e limitar o conteúdo do jogo E do Hero */
        .content-area {
            max-width: 960px; /* Largura ideal para leitura de parágrafos */
            margin-left: auto;
            margin-right: auto;
        }
        /* ---------------------------------------------------- */


        /* Classes para a linha vertical e horizontal (1px de espessura) */
        .divider-h {
            width: 100%;
            max-width: 1440px;
            height: 1px;
            background-color: var(--color-dark);
            margin: 40px auto;
        }

        /* Efeito de Batente/Sombra 3D para os botões Opção A/B */
        .button-wrapper-3d {
            position: relative;
            display: inline-block;
            /* Batente de 4px por baixo e à direita (cor escura) */
            box-shadow: 4px 4px 0px 0px var(--color-dark); 
            border-radius: 0.5rem;
            transition: box-shadow 0.15s ease, transform 0.15s ease;
        }

        /* Move o wrapper ligeiramente para cima/esquerda para simular o "clique" no hover */
        .button-wrapper-3d:hover:not(.cursor-not-allowed) {
            transform: translate(2px, 2px); 
            /* Reduz o batente para simular que está a "passar a linha" */
            box-shadow: 2px 2px 0px 0px var(--color-dark); 
        }

        /* O botão em si (a parte que se move e inverte cor) */
        .button-effect {
            /* Garante o arredondamento */
            border-radius: 0.5rem; /* rounded-lg */
            
            /* Borda escura de 1px (sempre visível) */
            border: 1px solid var(--color-dark); 
            
            /* Cor inicial (fundo escuro, texto claro) */
            background-color: var(--color-dark);
            color: var(--color-light);
            cursor: pointer;
            
            /* Transição para a inversão de cores */
            transition: background-color 0.15s ease, color 0.15s ease;
        }
        
        /* Inverte cores no hover */
        .button-wrapper-3d:hover:not(.cursor-not-allowed) .button-effect {
            background-color: var(--color-light); 
            color: var(--color-dark);
        }
        
        /* Estilo de Opacidade e Cursor para botões desativados */
        .button-wrapper-3d.cursor-not-allowed {
            opacity: 0.5;
            cursor: not-allowed;
            box-shadow: 0px 0px 0px 0px var(--color-dark); /* Remove a sombra quando desativado */
            transform: none;
        }
        .button-wrapper-3d.cursor-not-allowed .button-effect {
            cursor: not-allowed;
        }

        /* Estilo para o botão de PDF/Link (INVERSO) - Mantido para consistência */
        .pdf-button-inverse {
            background-color: var(--color-light); 
            color: var(--color-dark); 
            border: 1px solid var(--color-dark);
            transition: all 0.2s ease;
        }
        /* Efeito de hover para o link ativo (quando não tem cursor-not-allowed) */
        a.pdf-button-inverse:hover:not(.cursor-not-allowed) {
            background-color: var(--color-dark); 
            color: var(--color-light); 
            /* Para o PDF, a borda mantém a cor escura */
            border-color: var(--color-dark);
        }
        
        /* NOVO: Estilo para o botão 100% (Amarelo) */
        .button-100-percent {
            background-color: #fcd34d; /* yellow-400 */
            color: var(--color-dark); 
            border: 1px solid #fcd34d;
            font-weight: 700;
        }
        .button-100-percent:hover:not(.cursor-not-allowed) {
            background-color: #fbbf24; /* yellow-500 */
            border-color: #fbbf24;
            color: var(--color-dark); 
        }

        /* Borda de 1px para as caixas de imagem, agora com aspect-square e centralização FORÇADA */
        .image-box {
            border: 1px solid var(--color-dark);
            border-radius: 0.5rem; /* Cantos arredondados */
            /* Garantir que os elementos SVG dentro da caixa fiquem centralizados (vertical e horizontal) */
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Estilo específico para o rodapé (FONTE ALTERADA PARA 12px) */
        .footer-gestalt {
            background-color: var(--color-dark);
            color: var(--color-light);
            height: 30px; 
            font-family: 'Inter', sans-serif; 
            font-size: 12px; /* Aumentado de 10px para 12px */
            font-weight: 300; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            margin-top: 40px; 
            padding: 0 1rem;
            overflow: hidden; 
        }
        .footer-content {
            display: flex;
            align-items: center;
            justify-content: center;
            flex-wrap: nowrap;
            max-width: 1440px;
            width: 100%;
        }
        .footer-content p {
            margin: 0;
            padding: 0 8px; 
            white-space: nowrap; 
        }
        @media (max-width: 640px) {
             .footer-content p:nth-child(2), .footer-content p:nth-child(3) {
                display: none;
            }
        }

        /* SPINNER CSS */
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        .spinner-small {
            animation: spin 1s linear infinite;
            display: inline-block;
            width: 16px;
            height: 16px;
            vertical-align: middle;
            margin-left: 8px;
        }
        .spinner-path {
             /* Cor do spinner: para ser visível no fundo escuro, usa a cor clara (var(--color-light)) */
            stroke: var(--color-light);
        }
        .text-fafafa { color: #fafafa; }




         .linha-divisoria {
            width: 100%;
            height: 1px;
            background-color: #27272a;
            margin: 32px 0;
        }

        .form-row {
            display: flex;
            align-items: center;
            gap: 16px;
            font-size: 20px;
        }

        .form-label {
            white-space: nowrap;
        }

        .input-text,
        .input-data {
            border: 1px solid #27272a;
            padding: 6px 10px;
            font-size: 18px;
            background-color: #fafafa;
            color: #27272a;
        }

        .input-text {
            flex: 1;
        }

        .input-data {
            width: 220px;
        }

        @media (max-width: 640px) {
            .form-row {
                flex-direction: column;
                align-items: flex-start;
            }

            .input-data {
                width: 100%;
            }
        }
        





    </style>
</head>
<body class="font-sans-gestalt">

    <!-- HERO BANNER (Secção 1 - Tecto) -->
    <header class="text-[var(--color-light)] flex items-center justify-center p-8 md:p-16" style="background-color: var(--color-dark);">
        <div class="main-container w-full py-8">
            <!-- CONTEÚDO DO HERO ALINHADO E CENTRADO (max-width: 960px) -->
            <div class="content-area"> 
                <!-- Título alterado para apenas "O Jogo dos Princípios" -->
                <p class="text-xs md:text-sm uppercase tracking-widest mb-1 opacity-70">O Jogo dos Princípios</p>
                <h1 class="text-4xl md:text-6xl font-extrabold leading-tight mb-6">
                    Gestalt: o princípio de tudo
                </h1>
                
                <!-- Texto introdutório com fonte Slab-Serif, entrelinha maior e conteúdo expandido -->
                <!-- MUDANÇA: Estilo inline adicionado para forçar a fonte Zilla Slab -->
                <p class="font-slab-gestalt text-xl md:text-2xl opacity-90" style="font-family: 'Zilla Slab', serif;">
                    A Teoria da Gestalt surgiu na Alemanha no início do século XX, com fundadores como Max Wertheimer, Kurt Koffka e Wolfgang Köhler. O seu princípio central é que o cérebro humano não processa a realidade como uma soma de partes isoladas, mas sim como totalidades organizadas, uma visão sintetizada no aforismo "O todo é maior do que a soma das suas partes". A nossa perceção inata tende a procurar a ordem, o significado e a forma completa, rejeitando a desordem e o caos para criar estruturas coesas e estáveis.
                    
                    <br><br>
                    
                    Este jogo foi desenhado para testar a sua compreensão sobre os principais princípios que regem a forma como percebemos o design e a informação. Ao aplicá-los, garantimos que a informação é comunicada de forma mais eficiente e intuitiva. 
                </p>
            </div>
       
            
 <div class="linha-divisoria"></div>

    <div class="form-row">
        <label class="form-label" for="nome">Formando/a:</label>

        <!-- Nome + apelido obrigatório -->
        <input 
            class="input-text"
            type="text"
            id="nome"
            name="nome"
            placeholder="Nome Sobrenome"
            required
            pattern="^[A-Za-zÀ-ÿ]+(\\s+[A-Za-zÀ-ÿ]+)+$"
            title="Por favor introduza o nome e o apelido."
        >

        <!-- Data — preenchida automaticamente -->
        <input 
            class="input-data"
            type="text"
            id="data"
            name="data"
            placeholder="DD/MM/AAAA HH:MM"
            readonly
        >
    </div>

    <div class="linha-divisoria"></div>

    <script>
        const nomeInput = document.getElementById("nome");
        const dataInput = document.getElementById("data");

        // Função para gerar data + hora formatada
        function gerarDataHora() {
            const agora = new Date();

            const dia = String(agora.getDate()).padStart(2, '0');
            const mes = String(agora.getMonth() + 1).padStart(2, '0'); // meses começam em 0
            const ano = agora.getFullYear();

            const horas = String(agora.getHours()).padStart(2, '0');
            const minutos = String(agora.getMinutes()).padStart(2, '0');

            return `${dia}/${mes}/${ano} ${horas}:${minutos}`;
        }

        // Quando o aluno termina o nome, preenche automaticamente a data
        nomeInput.addEventListener("blur", function () {
            const valor = nomeInput.value.trim();

            // Verifica se tem pelo menos duas palavras
            const regex = /^[A-Za-zÀ-ÿ]+(\s+[A-Za-zÀ-ÿ]+)+$/;

            if (regex.test(valor)) {
                dataInput.value = gerarDataHora();
            } else {
                dataInput.value = "";
            }
        });
    </script>












        </div>
    </header>

    <!-- CONTAINER PRINCIPAL DO JOGO (limita a largura a 1440px) -->
    <main id="game-container" class="main-container game-section-text p-4 md:p-8"> 
        <!-- Linha divisória após o Hero Banner/Texto Introdutório -->
        <div class="divider-h"></div>

        <!-- Estrutura de dados dos Princípios da Gestalt -->
        <script>
            // Triângulo Equilátero (Corrigido para ser bem desenhado e centrado em 100, 100)
            const trianglePoints = "100,60 140,140 60,140";
            
            const gestaltData = [
                {
                    id: 'proximidade',
                    principio: "Proximidade",
                    descricaoCurta: "Elementos próximos são vistos como um grupo coeso, independentemente das suas diferenças. Vamos jogar e ganhar, escolha a imagem que lhe parece mais correta.",
                    explicacaoLonga: "O Princípio da Proximidade afirma que elementos colocados perto uns dos outros tendem a ser percebidos como um grupo ou unidade. No e-learning, use isto para estruturar conteúdo: agrupar botões relacionados, listas de tópicos ou texto que pertence ao mesmo parágrafo. Isso reduz a carga cognitiva, pois o utilizador entende a relação sem ter que a ler explicitamente, melhorando a escaneabilidade.",
                    // CORRETO: 4 filas de 2 Quadrados e 2 Círculos, em 2 grupos, centrados (largura total 125px).
                    svgCorreto: `<svg class="w-full h-full" viewBox="0 0 200 200">
                        <!-- Linha 1: 2 Quadrados (x + 7.5) e 2 Círculos (cx + 7.5, cy + 7.5) -->
                        <rect class="svg-shape-dark" x="37.5" y="62.5" width="15" height="15" /><rect class="svg-shape-dark" x="57.5" y="62.5" width="15" height="15" />
                        <circle class="svg-shape-dark" cx="127.5" cy="70" r="7.5" /><circle class="svg-shape-dark" cx="147.5" cy="70" r="7.5" />
                        <!-- Linha 2: 2 Quadrados e 2 Círculos -->
                        <rect class="svg-shape-dark" x="37.5" y="82.5" width="15" height="15" /><rect class="svg-shape-dark" x="57.5" y="82.5" width="15" height="15" />
                        <circle class="svg-shape-dark" cx="127.5" cy="90" r="7.5" /><circle class="svg-shape-dark" cx="147.5" cy="90" r="7.5" />
                        <!-- Linha 3: 2 Quadrados e 2 Círculos -->
                        <rect class="svg-shape-dark" x="37.5" y="102.5" width="15" height="15" /><rect class="svg-shape-dark" x="57.5" y="102.5" width="15" height="15" />
                        <circle class="svg-shape-dark" cx="127.5" cy="110" r="7.5" /><circle class="svg-shape-dark" cx="147.5" cy="110" r="7.5" />
                        <!-- Linha 4: 2 Quadrados e 2 Círculos -->
                        <rect class="svg-shape-dark" x="37.5" y="122.5" width="15" height="15" /><rect class="svg-shape-dark" x="57.5" y="122.5" width="15" height="15" />
                        <circle class="svg-shape-dark" cx="127.5" cy="130" r="7.5" /><circle class="svg-shape-dark" cx="147.5" cy="130" r="7.5" />
                    </svg>`, 
                    // ERRADO: 4 filas de 4 quadrados uniformemente espaçados
                    svgErrado: `<svg class="w-full h-full" viewBox="0 0 200 200">
                        <!-- Linha 1: 4 quadrados uniformes -->
                        <rect class="svg-shape-dark" x="30" y="62.5" width="15" height="15" /><rect class="svg-shape-dark" x="70" y="62.5" width="15" height="15" />
                        <rect class="svg-shape-dark" x="110" y="62.5" width="15" height="15" /><rect class="svg-shape-dark" x="150" y="62.5" width="15" height="15" />
                        <!-- Linha 2: 4 quadrados uniformes -->
                        <rect class="svg-shape-dark" x="30" y="82.5" width="15" height="15" /><rect class="svg-shape-dark" x="70" y="82.5" width="15" height="15" />
                        <rect class="svg-shape-dark" x="110" y="82.5" width="15" height="15" /><rect class="svg-shape-dark" x="150" y="82.5" width="15" height="15" />
                        <!-- Linha 3: 4 quadrados uniformes -->
                        <rect class="svg-shape-dark" x="30" y="102.5" width="15" height="15" /><rect class="svg-shape-dark" x="70" y="102.5" width="15" height="15" />
                        <rect class="svg-shape-dark" x="110" y="102.5" width="15" height="15" /><rect class="svg-shape-dark" x="150" y="102.5" width="15" height="15" />
                         <!-- Linha 4: 4 quadrados uniformes -->
                        <rect class="svg-shape-dark" x="30" y="122.5" width="15" height="15" /><rect class="svg-shape-dark" x="70" y="122.5" width="15" height="15" />
                        <rect class="svg-shape-dark" x="110" y="122.5" width="15" height="15" /><rect class="svg-shape-dark" x="150" y="122.5" width="15" height="15" />
                    </svg>`,
                },
                {
                    id: 'similaridade',
                    principio: "Similaridade",
                    descricaoCurta: "Elementos com características visuais semelhantes são percebidos como relacionados ou parte do mesmo conjunto. Vamos jogar e ganhar, escolha a imagem que lhe parece mais correta.",
                    explicacaoLonga: "A Similaridade ocorre quando elementos que partilham cor, forma, tamanho ou orientação são vistos como pertencentes ao mesmo grupo. Para e-conteúdos, a aplicação é crucial: utilize cores e ícones consistentes para categorias ou ações (ex: todos os botões de 'Avançar' são azuis, todos os 'Links' são sublinhados). Isso cria uma linguagem visual unificada que guia o utilizador intuitivamente através do material didático.",
                    // CORRETO: 4 Quadrados Grandes e 4 Círculos, agrupados e próximos.
                    svgCorreto: `<svg class="w-full h-full" viewBox="0 0 200 200">
                        <!-- Grupo 1 (4 Quadrados Grandes - 20x20) -->
                        <rect class="svg-shape-dark" x="40" y="80" width="20" height="20" />
                        <rect class="svg-shape-dark" x="70" y="80" width="20" height="20" />
                        <rect class="svg-shape-dark" x="40" y="110" width="20" height="20" />
                        <rect class="svg-shape-dark" x="70" y="110" width="20" height="20" />
                        <!-- Grupo 2 (4 Círculos - Raio 10) -->
                        <circle class="svg-shape-dark" cx="130" cy="90" r="10" />
                        <circle class="svg-shape-dark" cx="160" cy="90" r="10" />
                        <circle class="svg-shape-dark" cx="130" cy="120" r="10" />
                        <circle class="svg-shape-dark" cx="160" cy="120" r="10" />
                    </svg>`, 
                    // ERRADO: Quadrados e Triângulos misturados aleatoriamente (não similar) - Manutenção do SVG anterior (Triângulos e Quadrados pequenos misturados)
                    svgErrado: `<svg class="w-full h-full" viewBox="0 0 200 200">
                        <!-- Linha 1: Q T Q T -->
                        <rect class="svg-shape-dark" x="30" y="70" width="15" height="15" />
                        <polygon class="svg-shape-dark" points="70,70 90,70 80,110" transform="translate(0, -10)" />
                        <rect class="svg-shape-dark" x="110" y="70" width="15" height="15" />
                        <polygon class="svg-shape-dark" points="150,70 170,70 160,110" transform="translate(0, -10)" />
                        <!-- Linha 2: T Q T Q -->
                        <polygon class="svg-shape-dark" points="30,110 50,110 40,150" transform="translate(0, -10)" />
                        <rect class="svg-shape-dark" x="70" y="110" width="15" height="15" />
                        <polygon class="svg-shape-dark" points="110,110 130,110 120,150" transform="translate(0, -10)" />
                        <rect class="svg-shape-dark" x="150" y="110" width="15" height="15" />
                    </svg>`, 
                },
                {
                    id: 'fechamento',
                    principio: "Fechamento",
                    descricaoCurta: "A nossa mente tem a capacidade de preencher lacunas e completar formas incompletas para ver figuras inteiras. Vamos jogar e ganhar, escolha a imagem que lhe parece mais correta.",
                    explicacaoLonga: "O Fechamento permite que o cérebro perceba uma forma completa mesmo quando faltam partes, ignorando as informações ausentes. No design de e-conteúdos, este princípio pode ser usado para criar ícones minimalistas ou designs de interface mais limpos. Ao usar o Fechamento, o designer reduz a complexidade visual sem sacrificar o reconhecimento, tornando a interface mais elegante e menos sobrecarregada de elementos gráficos.",
                    // CORRETO: Quatro cantos de um quadrado implícito, um exemplo clássico de fechamento. AGORA COM STROKE-WIDTH 3
                    svgCorreto: `<svg class="w-full h-full" viewBox="0 0 200 200" stroke-width="3" fill="none" stroke="var(--color-dark)" stroke-linecap="square">
                        <!-- Canto Superior Esquerdo -->
                        <path d="M 60 80 L 60 60 L 80 60" />
                        <!-- Canto Superior Direito -->
                        <path d="M 140 80 L 140 60 L 120 60" />
                        <!-- Canto Inferior Esquerdo -->
                        <path d="M 60 120 L 60 140 L 80 140" />
                        <!-- Canto Inferior Direito -->
                        <path d="M 140 120 L 140 140 L 120 140" />
                    </svg>`, 
                    // ERRADO: Linha reta e arco que não formam uma figura coesa para forçar o fechamento.
                    svgErrado: `<svg class="w-full h-full" viewBox="0 0 200 200" stroke-width="3" fill="none" stroke="var(--color-dark)" stroke-linecap="round">
                        <!-- Linha horizontal -->
                        <line x1="60" y1="80" x2="140" y2="80" />
                        <!-- Curva (arco de baixo) -->
                        <path d="M 60 120 C 80 150, 120 150, 140 120" />
                    </svg>`, 
                },
                {
                    id: 'continuidade',
                    principio: "Continuidade",
                    descricaoCurta: "O olhar segue o caminho mais suave e menos interrompido, percebendo linhas ou curvas como uma única entidade. Vamos jogar e ganhar, escolha a imagem que lhe parece mais correta.",
                    explicacaoLonga: "O princípio da Continuidade dita que os elementos dispostos numa linha ou curva são percebidos como relacionados, tendendo a prolongar a direção de uma linha que está a ser seguida. Em interfaces e e-conteúdos, use linhas de tempo, setas ou barras de progresso que fluem suavemente para indicar o progresso do aluno. Evite interrupções visuais abruptas que possam quebrar o fluxo de leitura ou a sequência lógica do material.",
                    // AGORA COM STROKE-WIDTH 3
                    svgCorreto: `<svg class="w-full h-full" viewBox="0 0 200 200" stroke-width="3" fill="none" stroke="var(--color-dark)" stroke-linecap="round">
                        <!-- Linha curva suave e contínua -->
                        <path d="M 30 150 C 70 50, 130 150, 170 50" />
                    </svg>`, 
                    // AGORA COM STROKE-WIDTH 3
                    svgErrado: `<svg class="w-full h-full" viewBox="0 0 200 200" stroke-width="3" fill="none" stroke="var(--color-dark)" stroke-linejoin="round">
                        <!-- Duas linhas que se cruzam e não formam um caminho único -->
                        <path d="M 30 150 L 170 50" />
                        <path d="M 30 50 L 170 150" />
                    </svg>`, 
                },
                {
                    id: 'figura-fundo',
                    principio: "Figura-Fundo",
                    descricaoCurta: "A nossa perceção organiza o campo visual separando o elemento principal do seu plano de fundo. Vamos jogar e ganhar, escolha a imagem que lhe parece mais correta.",
                    explicacaoLonga: "A Figura-Fundo é a capacidade de distinguir um objeto principal (a figura) do seu ambiente (o fundo). A figura é geralmente percebida com contornos mais definidos e mais memorável. No design instrucional, isto significa garantir contraste elevado entre o texto e o fundo (acessibilidade) e usar o espaço em branco (negativo) estrategicamente. O elemento mais importante (a questão, o botão de ação) deve ser a figura, e o fundo deve ser neutro e submisso, focando a atenção do aluno.",
                    // CORRETO: Grande contraste (Figura clara em Fundo escuro) - Sem texto/stroke
                    svgCorreto: `<svg class="w-full h-full" viewBox="0 0 200 200" style="background-color: var(--color-dark);">
                        <!-- Retângulo (A figura) em cor clara -->
                        <rect class="svg-shape-light" x="50" y="50" width="100" height="100" rx="10" fill="var(--color-light)" stroke="none"/>
                    </svg>`, 
                    // ERRADO: Contraste muito baixo (Quadrado cinzento muito claro em fundo claro) - Contraste ainda mais baixo
                    svgErrado: `<svg class="w-full h-full" viewBox="0 0 200 200" style="background-color: var(--color-light);">
                        <!-- O quadrado é um cinzento muito claro, dificultando a distinção (Contraste Mínimo) -->
                        <rect x="50" y="50" width="100" height="100" rx="10" fill="var(--color-very-low-contrast)" stroke="none"/>
                    </svg>`, 
                },
                {
                    id: 'pregnancia',
                    principio: "Pregnância",
                    descricaoCurta: "O cérebro prefere interpretar formas ambíguas da maneira mais simples, estável e completa possível. Vamos jogar e ganhar, escolha a imagem que lhe parece mais correta.",
                    explicacaoLonga: "A Pregnância (ou Boa Forma) é o princípio mestre: a tendência a reduzir a complexidade a uma forma básica e estável. Para e-conteúdos, isto significa minimalismo e clareza. Use layouts e gráficos simples, diretos e sem ruído visual. Evite gradientes desnecessários, múltiplas caixas de texto ou setas em excesso. Quanto mais simples e 'boa' a forma visual, mais rapidamente o aluno processa a informação e menor é a probabilidade de erros de interpretação.",
                    // CORRETO ATUALIZADO: Centrado em (100, 100) com sobreposição vertical (Distância vertical entre centros D=35, Raio r=20).
                    svgCorreto: `<svg class="w-full h-full" viewBox="0 0 200 200" stroke-width="3" fill="none" stroke="var(--color-dark)" stroke-linecap="round">
                        <!-- Filha Superior (cy=82.5) -->
                        <circle cx="60" cy="82.5" r="20" />
                        <circle cx="100" cy="82.5" r="20" />
                        <circle cx="140" cy="82.5" r="20" />
                        <!-- Fila Inferior (cy=117.5) -->
                        <circle cx="80" cy="117.5" r="20" />
                        <circle cx="120" cy="117.5" r="20" />
                    </svg>`, 
                    // ERRADO: Scatter plot de formas diferentes, completamente caótico e sem Boa Forma.
                    svgErrado: `<svg class="w-full h-full" viewBox="0 0 200 200" fill="var(--color-dark)" stroke="none">
                        <!-- Scatter de pequenos elementos de diferentes formas (quadrados, círculos, triângulos) -->
                        <rect x="30" y="50" width="10" height="10" />
                        <circle cx="60" cy="40" r="6" />
                        <polygon points="100,30 115,50 85,50" />
                        <circle cx="140" cy="60" r="4" />
                        
                        <polygon points="40,80 50,100 30,100" />
                        <rect x="70" y="110" width="8" height="8" />
                        <circle cx="100" cy="85" r="7" />
                        <rect x="140" y="120" width="12" height="12" />
                        
                        <circle cx="50" cy="140" r="5" />
                        <polygon points="80,150 90,170 70,170" />
                        <rect x="120" y="160" width="10" height="10" />
                        <circle cx="160" cy="170" r="6" />
                    </svg>`, 
                },
                {
                    id: 'destino-comum',
                    principio: "Destino Comum",
                    descricaoCurta: "Elementos que se movem, ou parecem mover-se, na mesma direção e velocidade são percebidos como um único grupo. Vamos jogar e ganhar, escolha a imagem que lhe parece mais correta.",
                    explicacaoLonga: "O Destino Comum é mais evidente em elementos em movimento, mas também se aplica a elementos estáticos que sugerem movimento (como setas). Em e-conteúdos interativos, use animações consistentes para que os objetos que partilham uma função (ex: um conjunto de cartões que desliza para a esquerda para a próxima lição) se movam em uníssono. Isso sinaliza ao utilizador que eles são funcionalmente ligados, facilitando a interação e o entendimento da estrutura da interface.",
                    // AGORA COM STROKE-WIDTH 3
                    svgCorreto: `<svg class="w-full h-full" viewBox="0 0 200 200" stroke-width="3" fill="none" stroke="var(--color-dark)" stroke-linejoin="round">
                        <path d="M 50 140 L 50 70 M 50 70 L 40 80 M 50 70 L 60 80" />
                        <path d="M 100 140 L 100 70 M 100 70 L 90 80 M 100 70 L 110 80" />
                        <path d="M 150 140 L 150 70 M 150 70 L 140 80 M 150 70 L 160 80" />
                    </svg>`, 
                    // AGORA COM STROKE-WIDTH 3
                    svgErrado: `<svg class="w-full h-full" viewBox="0 0 200 200" stroke-width="3" fill="none" stroke="var(--color-dark)" stroke-linejoin="round">
                        <path d="M 50 140 L 50 70 M 50 70 L 40 80 M 50 70 L 60 80" />
                        <path d="M 100 70 L 100 140 M 100 140 L 110 130 M 100 140 L 90 130" /> <!-- Aponta para baixo -->
                        <path d="M 150 140 L 150 70 M 150 70 L 140 80 M 150 70 L 160 80" />
                    </svg>`,
                }
            ];

            let score = 0;
            const totalQuestions = gestaltData.length;

            /**
             * Função que renderiza todas as secções de jogo
             */
            function renderGameSections() {
                const gameContainer = document.getElementById('game-container');
                
                // Remove todo o conteúdo existente no main
                gameContainer.innerHTML = '';
                
                // Adiciona a linha divisória
                gameContainer.appendChild(document.createElement('div')).className = 'divider-h';

                gestaltData.forEach((data, index) => {
                    // Randomiza a posição da resposta correta
                    const isCorrectLeft = Math.random() < 0.5;
                    data.respostaCorreta = isCorrectLeft ? 'left' : 'right';
                    data.answered = false; // Reset de estado para garantir novo jogo
                    
                    // Os SVGs agora usam h-full e w-full, e o container é aspect-square
                    const svg1 = isCorrectLeft ? data.svgCorreto : data.svgErrado;
                    const svg2 = isCorrectLeft ? data.svgErrado : data.svgCorreto;

                    const choice1 = isCorrectLeft ? 'correct' : 'incorrect';
                    const choice2 = isCorrectLeft ? 'incorrect' : 'correct';

                    const section = document.createElement('section');
                    section.id = data.id;
                    section.className = 'py-10 md:py-16 content-area'; // Aplica content-area para limitar e centrar o conteúdo

                    section.innerHTML = `
                        <!-- Título da Secção -->
                        <h3 class="text-[24px] font-bold mb-2 uppercase">${data.principio}</h3>
                        <!-- Introdução: Aplicada classe max-w-lg (aprox. 640px) à descrição curta -->
                        <p class="mb-8 max-w-lg">${data.descricaoCurta}</p>

                        <div class="flex flex-col lg:flex-row w-full justify-between items-center space-y-8 md:space-y-0 md:space-x-10">
                            <!-- Imagens e Botões -->
                            <div class="flex flex-col md:flex-row w-full justify-between items-center space-y-8 md:space-y-0 md:space-x-10">
                                
                                <!-- Opção Esquerda: adicionado aspect-square e removido h-56 -->
                                <div class="w-full md:w-1/2 flex flex-col items-center">
                                    <div id="image-${data.id}-left" class="p-4 w-full rounded-lg cursor-pointer transition duration-300 hover:bg-gray-50 image-box aspect-square" 
                                         onclick="handleChoice('${data.id}', 'left', '${choice1}', ${index})"
                                         title="Escolher imagem da esquerda">
                                        ${svg1}
                                    </div>
                                    <!-- NOVO: Wrapper com o efeito de batente -->
                                    <div id="wrapper-${data.id}-left" class="mt-4 button-wrapper-3d">
                                        <button class="px-6 py-2 button-effect" 
                                                onclick="handleChoice('${data.id}', 'left', '${choice1}', ${index})">
                                            Opção A
                                        </button>
                                    </div>
                                </div>
                                
                                <!-- Opção Direita: adicionado aspect-square e removido h-56 -->
                                <div class="w-full md:w-1/2 flex flex-col items-center">
                                    <div id="image-${data.id}-right" class="p-4 w-full rounded-lg cursor-pointer transition duration-300 hover:bg-gray-50 image-box aspect-square"
                                         onclick="handleChoice('${data.id}', 'right', '${choice2}', ${index})"
                                         title="Escolher imagem da direita">
                                        ${svg2}
                                    </div>
                                    <!-- NOVO: Wrapper com o efeito de batente -->
                                    <div id="wrapper-${data.id}-right" class="mt-4 button-wrapper-3d">
                                        <button class="px-6 py-2 button-effect"
                                                onclick="handleChoice('${data.id}', 'right', '${choice2}', ${index})">
                                            Opção B
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Feedback e Explicação (aplicado content-area) -->
                        <div id="feedback-${data.id}" class="mt-8 p-6 rounded-lg border-l-4 border-gray-400 text-sm hidden">
                            <!-- O conteúdo será preenchido pelo JS -->
                        </div>
                    `;
                    gameContainer.appendChild(section);

                    // Adiciona a linha divisória (exceto na última secção)
                    if (index < totalQuestions - 1) {
                        gameContainer.appendChild(document.createElement('div')).className = 'divider-h';
                    }
                });

                // Renderiza a secção de resultados no final
                renderResultsSection();
            }

            /**
             * Lida com a escolha do utilizador
             * @param {string} id - O ID do princípio.
             * @param {string} choice - 'left' ou 'right'.
             * @param {string} type - 'correct' ou 'incorrect'.
             * @param {number} index - Índice no array gestaltData.
             */
            function handleChoice(id, choice, type, index) {
                const feedbackEl = document.getElementById(`feedback-${id}`);
                const data = gestaltData[index];
                
                // Elementos para controlo do batente/click
                const wrapperLeft = document.getElementById(`wrapper-${id}-left`);
                const wrapperRight = document.getElementById(`wrapper-${id}-right`);

                // Elementos para controlo da imagem (box)
                const imageLeft = document.getElementById(`image-${id}-left`);
                const imageRight = document.getElementById(`image-${id}-right`);

                // Limpa o feedback visual anterior
                imageLeft.style.backgroundColor = '';
                imageRight.style.backgroundColor = '';
                
                const isCorrect = type === 'correct';

                // Impede múltiplos cliques corretos
                if (data.answered && isCorrect) return;

                // Armazena o estado da resposta (independentemente de estar correta ou não)
                // Apenas marca como 'answered' se for a primeira resposta correta
                if (isCorrect) {
                    // Atualiza o score
                    data.answered = true;
                    score = gestaltData.filter(q => q.answered).length;
                    updateScoreDisplay(); // Atualiza a exibição da pontuação imediatamente

                    feedbackEl.className = 'mt-8 p-6 rounded-lg border-l-4 border-green-600 bg-green-50 text-green-800 text-sm block';
                    feedbackEl.innerHTML = `
                        <p class="font-bold text-base mb-2">Parabéns! Resposta Correta! (${data.principio})</p>
                        <p class="leading-relaxed max-w-4xl game-section-text">${data.explicacaoLonga}</p>
                    `;
                    document.getElementById(`image-${id}-${choice}`).style.backgroundColor = '#d1fae5'; // Verde claro
                    
                    // Desativa ambas as opções (wrapper)
                    wrapperLeft.classList.add('cursor-not-allowed');
                    wrapperRight.classList.add('cursor-not-allowed');
                    wrapperLeft.querySelector('button').onclick = null;
                    wrapperRight.querySelector('button').onclick = null;
                    // Desativa o clique na imagem
                    imageLeft.onclick = null;
                    imageRight.onclick = null;
                    

                } else {
                    // Se for incorreta
                    feedbackEl.className = 'mt-8 p-6 rounded-lg border-l-4 border-red-600 bg-red-50 text-red-800 text-sm block';
                    feedbackEl.innerHTML = `
                        <p class="font-bold text-base mb-2">Ops! Resposta Incorreta. Tente novamente!</p>
                        <p class="leading-relaxed game-section-text">Estes elementos não formam uma boa figura segundo o princípio. Escolha a outra opção para ver a explicação correta.</p>
                    `;
                    document.getElementById(`image-${id}-${choice}`).style.backgroundColor = '#fee2e2'; // Vermelho claro
                    
                    // Desativa apenas a opção clicada incorretamente (wrapper)
                    const clickedWrapper = document.getElementById(`wrapper-${id}-${choice}`);
                    clickedWrapper.classList.add('cursor-not-allowed');
                    clickedWrapper.querySelector('button').onclick = null;
                    document.getElementById(`image-${id}-${choice}`).onclick = null;

                }

                // Verifica se todas as respostas foram dadas para atualizar o resultado final
                if (gestaltData.filter(q => q.answered).length === totalQuestions) {
                    updateResults();
                } else {
                    // Mesmo que não tenha terminado, atualiza o resultado para garantir que o link é ativado se a percentagem for atingida
                    updateResults();
                }
            }

            /**
             * Atualiza a exibição da pontuação (em %) no placar.
             */
            function updateScoreDisplay() {
                 const score = gestaltData.filter(q => q.answered).length;
                 const scorePercentage = (score / totalQuestions) * 100;
                 document.getElementById('current-score').textContent = `${scorePercentage.toFixed(0)}%`;
            }

            /**
             * Renderiza a secção de resultados no final da página.
             */
            function renderResultsSection() {
                const gameContainer = document.getElementById('game-container');
                const resultsSection = document.createElement('section');
                resultsSection.id = 'results-section';
                resultsSection.className = 'py-10 md:py-16 text-center content-area'; // Aplica content-area para limitar e centrar o conteúdo
                
                // NOVO: A mensagem inicial 'a aguardar' com o estilo solicitado
                const initialMessage = `<span class="text-fafafa lowercase">a aguardar</span>
                                        <svg class="spinner-small" viewBox="0 0 50 50">
                                            <circle class="path spinner-path" cx="25" cy="25" r="20" fill="none" stroke-width="5" stroke-dasharray="80" stroke-dashoffset="60"></circle>
                                        </svg>`;

                resultsSection.innerHTML = `
                    <h3 class="text-[24px] font-bold mb-4 uppercase game-section-text">Resultado Final do Jogo</h3>
                    <p class="mb-4 game-section-text">Responda a todas as ${totalQuestions} questões para ver o seu resultado!</p>
                    <!-- Bloco de Pontuação: Fundo escuro, Texto claro, Borda clara -->
                    <div id="final-score-display" class="p-8 border-1 rounded-xl inline-block max-w-lg mx-auto bg-[var(--color-dark)] text-[var(--color-light)]" style="border-width: 1px; border-color: var(--color-light);">
                        <!-- O texto '0%' é o padrão inicial, atualizado por JS -->
                        <p class="text-xl">Pontuação: <span id="current-score">0%</span></p> 
                        <!-- Limite de 86% para receber o presente -->
                        <p class="text-sm opacity-80">(Mínimo de 86% necessário para o 1º presente)</p>
                        <p id="pass-fail-message" class="mt-4 text-2xl" style="color: #fafafa; min-height: 90px;" data-waiting-style="true">
                            ${initialMessage}
                        </p>
                        
                        <!-- Link 1 (Prémio 86%+ - Link 4ED) - Desativado por defeito -->
                        <a id="external-link-button" href="#" target="_blank"
                           class="mt-6 px-8 py-3 rounded-lg pdf-button-inverse inline-block opacity-50 cursor-not-allowed transition duration-150 ease-in-out"
                           onclick="if(this.classList.contains('cursor-not-allowed')) { event.preventDefault(); console.log('É necessário no mínimo 86% de acertos para receber o presente.'); }">
                            Receber o meu presente (86%+) →
                        </a>

                        <!-- Link 2 (Prémio 100% - Vídeo) - Inicialmente ESCONDIDO (opacity-0 + pointer-events-none) -->
                        <a id="external-link-button-100" href="#" target="_blank"
                            class="mt-4 px-8 py-3 rounded-lg button-100-percent inline-block opacity-0 pointer-events-none cursor-not-allowed transition duration-150 ease-in-out">
                             Prémio Especial (100% Acertos) - Ver Vídeo Exclusivo →
                        </a>
                    </div>
                `;
                gameContainer.appendChild(document.createElement('div')).className = 'divider-h';
                gameContainer.appendChild(resultsSection);
            }

            /**
             * Atualiza a secção de resultados após a conclusão do jogo.
             */
            function updateResults() {
                // Recalcula o score total das questões respondidas corretamente
                score = gestaltData.filter(q => q.answered).length;
                const scorePercentage = (score / totalQuestions) * 100;
                
                const passThreshold = 86; // Mínimo de 86% para receber o presente (5/6)
                const perfectScore = 100; // 100% de acertos (6/6)

                const currentScoreEl = document.getElementById('current-score');
                const messageEl = document.getElementById('pass-fail-message');
                const linkBtn = document.getElementById('external-link-button'); // Link 86%+
                const linkBtn100 = document.getElementById('external-link-button-100'); // Link 100%
                
                // Garante que o score % esteja atualizado
                currentScoreEl.textContent = `${scorePercentage.toFixed(0)}%`;
                
                // --- SETUP INICIAL: DESATIVAÇÃO DE AMBOS OS LINKS ---
                // Lógica de Desativação do Link 100%
                linkBtn100.classList.add('opacity-0', 'pointer-events-none', 'cursor-not-allowed');
                linkBtn100.href = '#';
                
                // Lógica de Desativação do Link 86%+
                linkBtn.classList.add('opacity-50', 'cursor-not-allowed');
                linkBtn.href = '#';
                // ----------------------------------------------------

                // Remove o estilo inicial de 'a aguardar' e o spinner
                if (gestaltData.filter(q => q.answered).length === totalQuestions || scorePercentage >= passThreshold) {
                     messageEl.removeAttribute('data-waiting-style');
                     messageEl.innerHTML = ''; 
                     messageEl.style.color = '';
                }
                
                // ----------------------------------------------------------------------------------
                // 1. Lógica para 100% (6/6)
                // ----------------------------------------------------------------------------------
                if (scorePercentage === perfectScore) {
                    
                    // Mensagem formatada para 100%
                    messageEl.innerHTML = 'FANTÁSTICO!<br>Atingiu a Pontuação Máxima (100%)!<br>Receba o seu Prémio Especial!';
                    messageEl.classList.add('text-yellow-400', 'font-extrabold'); // Cor amarela
                    messageEl.classList.remove('text-red-400', 'text-green-400');
                    
                    // ATIVA o link 86%+ 
                    linkBtn.classList.remove('opacity-50', 'cursor-not-allowed');
                    linkBtn.href = 'https://4ed.com.br/gestalt/'; 

                    // ATIVA o link 100%
                    linkBtn100.classList.remove('opacity-0', 'pointer-events-none', 'cursor-not-allowed');
                    linkBtn100.href = 'https://youtu.be/yPlGJuPQwho?si=-Pj51NSSGtLP2AC5'; 
                    
                // ----------------------------------------------------------------------------------
                // 2. Lógica para 86% a 99% (5/6)
                // ----------------------------------------------------------------------------------
                } else if (scorePercentage >= passThreshold) {
                    
                    // Mensagem formatada para 86%+
                    messageEl.innerHTML = 'PARABÉNS!<br>Aprovado(a)!<br>Ganhou um presente.';
                    messageEl.classList.add('text-green-400', 'font-extrabold'); // Cor verde
                    messageEl.classList.remove('text-red-400', 'text-yellow-400');
                    
                    // ATIVA o link 86%+
                    linkBtn.classList.remove('opacity-50', 'cursor-not-allowed');
                    linkBtn.href = 'https://4ed.com.br/gestalt/';
                    
                // ----------------------------------------------------------------------------------
                // 3. Lógica para Reprovado (< 86%)
                // ----------------------------------------------------------------------------------
                } else {
                    // Apenas se o jogo estiver COMPLETAMENTE TERMINADO, mostra a mensagem de falha final
                    if (gestaltData.filter(q => q.answered).length === totalQuestions) {
                        messageEl.textContent = `Não Aprovado(a). A sua nota (${scorePercentage.toFixed(0)}%) não atingiu os ${passThreshold}% necessários. Reveja os princípios e tente novamente!`;
                        messageEl.classList.add('text-red-400', 'font-extrabold'); // Cor vermelha
                        messageEl.classList.remove('text-green-400', 'text-yellow-400');
                    } else {
                         // Se não terminou, e o estado inicial foi removido (e.g. após uma tentativa falhada)
                         if (messageEl.innerHTML === '') {
                             messageEl.innerHTML = `<span class="text-yellow-400 font-extrabold">A aguardar a conclusão do jogo...</span>`;
                             messageEl.classList.remove('text-red-400', 'text-green-400');
                         }
                    }
                }
            }

            // Inicializa as secções do jogo ao carregar a página
            document.addEventListener('DOMContentLoaded', renderGameSections);
        </script>
    </main>
    
    <!-- RODAPÉ - Ajustado com altura de 30px, fonte 12px light e cor #27272a -->
    <footer class="footer-gestalt">
        <div class="footer-content">
            <p>Eduardo Firmino // 2025</p>
            <p class="hidden sm:block">Ação: Formador à Distância | E-Conteúdos | E-Learning</p>
            <p class="hidden sm:block">Modalidade: Formador + Digital (F+D)</p>
        </div>
    </footer>

</body>
</html>